source suite/period/engines.inc;

create or replace table t (id int, s date, e date, period for apptime(s,e));

insert into t values(1, '1999-01-01', '2018-12-12');
insert into t values(1, '1999-01-01', '2017-01-01');
insert into t values(1, '2017-01-01', '2019-01-01');
insert into t values(2, '1998-01-01', '2018-12-12');
insert into t values(3, '1997-01-01', '2015-01-01');
insert into t values(4, '2016-01-01', '2020-01-01');
update t for portion of apptime from '2000-01-01' to '2018-01-01'
       set id=id + 5;
select * from t;

--echo # Modify period start/end fields
truncate t;
insert into t values(1, '1999-01-01', '2018-12-12');
insert into t values(1, '1999-01-01', '2017-01-01');
update t for portion of apptime from '2000-01-01' to '2018-01-01'
       set id= id + 5, s=subdate(s, 5), e=adddate(e, 5);
select * from t;

--echo # Precision timestamps
create or replace table t (id int, s timestamp(5), e timestamp(5),
                           period for apptime(s,e));
insert into t values(1, '1999-01-01', '2018-12-12');
insert into t values(1, '1999-01-01', '2017-01-01');
update t for portion of apptime from '2000-01-01 00:00:00.00015'
                                to '2018-01-01 12:34:56.31415'
         set s='1999-09-09 3:14:15.926535', id= id + 5;
select * from t;

-- echo # Strings
create or replace table t (id int, str text, s date, e date,
                           period for apptime(s,e));

insert into t values(1, 'data', '1999-01-01', '2018-12-12');
insert into t values(1, 'other data', '1999-01-01', '2018-12-12');
update t for portion of apptime from '2000-01-01' to '2018-01-01'
       set id= id + 5;
select * from t;

create or replace database test;
