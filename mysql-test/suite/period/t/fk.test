create or replace table t (id int, s date, e date, period for p(s,e),
                           primary key(id, p without overlaps));
show create table t_cont;

drop table t;
show tables from test;

insert into t values(1, '2000-01-01', '2000-01-02');
select * from t;

# TODO
create table t_cont(id int);
--error ER_TABLE_EXISTS_ERROR
create or replace table t (id int, s date, e date, period for p(s,e),
                           primary key(id, p without overlaps));

create or replace table t (id int, s date, e date, period for p(s,e),
                           primary key(id, p without overlaps));
lock table t write;
--error ER_TABLE_NOT_LOCKED
drop table t;
unlock table t;
drop table t;

# TODO
lock table t_cont write;
--error ER_TABLE_NOT_LOCKED
drop table t;
unlock table t;
drop table t;

create or replace table tt(x int, s date, e date, period for p(s,e), primary key(x, p without overlaps));
insert into tt values(1, '2000-01-01', '2000-01-02');
insert into tt values(1, '2000-01-03', '2000-01-07');
insert into tt values(1, '2000-01-07', '2000-01-08');
select * from tt_cont;
insert into tt values(1, '2000-01-02', '2000-01-03');
select * from tt_cont;

update tt set s= '2000-01-08', e= '2000-01-09' where s = '2000-01-02';
select * from tt_cont;
update tt set e= '2000-01-03' where s = '2000-01-01';
select * from tt_cont;

delete from tt where s = '2000-01-08';
select * from tt_cont;
delete from tt where s = '2000-01-03';
select * from tt_cont;
insert into tt values(1, '2000-01-03', '2000-01-07');
delete from tt where s = '2000-01-01';
select * from tt_cont;
delete from tt;
select * from tt_cont;
