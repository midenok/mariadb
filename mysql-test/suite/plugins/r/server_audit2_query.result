CREATE TABLE IF NOT EXISTS mysql.server_audit_filters (
filtername char(80) COLLATE utf8_bin NOT NULL DEFAULT '',
rule longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL DEFAULT 'true' CHECK (json_valid(rule)),
CONSTRAINT c_filtername UNIQUE (filtername)
) ENGINE=Aria;
CREATE TABLE IF NOT EXISTS mysql.server_audit_users (host char(60) COLLATE utf8_bin NOT NULL DEFAULT '',
user char(80) COLLATE utf8_bin NOT NULL DEFAULT '',
filtername char(80) NOT NULL DEFAULT '',
CONSTRAINT c_host_user UNIQUE (host, user)
) ENGINE=Aria;
install plugin server_audit soname 'server_audit2';
show variables like 'server_audit%';
Variable_name	Value
server_audit_file_path	server_audit.log
server_audit_file_rotate_now	OFF
server_audit_file_rotate_size	1000000
server_audit_file_rotations	9
server_audit_logging	OFF
server_audit_mode	0
server_audit_output_type	file
server_audit_query_log_limit	1024
server_audit_reload_filters	OFF
server_audit_syslog_facility	LOG_USER
server_audit_syslog_ident	mysql-server_auditing
server_audit_syslog_info	
server_audit_syslog_priority	LOG_INFO
INSERT INTO mysql.server_audit_filters VALUES ('default','{"logging" : "off"}');
INSERT INTO mysql.server_audit_filters VALUES ('query_all','{"query_event" : "ALL"}');
INSERT INTO mysql.server_audit_filters VALUES ('query_read','{"query_event" : "DML_READ"}');
INSERT INTO mysql.server_audit_filters VALUES ('query_write','{"query_event" : "DML_WRITE"}');
INSERT INTO mysql.server_audit_filters VALUES ('query_dml','{"query_event" : "DML"}');
INSERT INTO mysql.server_audit_filters VALUES ('query_ddl','{"query_event" : "DDL"}');
INSERT INTO mysql.server_audit_filters VALUES ('query_dcl','{"query_event" : "DCL"}');
INSERT INTO mysql.server_audit_filters VALUES ('query_dml_no_select','{"query_event" : "DML_NO_SELECT"}');
INSERT INTO mysql.server_audit_filters VALUES ('query_combined','{"query_event" : ["DDL","DCL"]}');
SET GLOBAL server_audit_logging=on;
INSERT INTO mysql.server_audit_users VALUES ('%','root','query_all');
SET GLOBAL server_audit_reload_filters=ON;
SHOW STATUS LIKE "Server_audit_session_filter";
Variable_name	Value
Server_audit_session_filter	query_all
connect  con1,localhost,root,,mysql;
connection default;
disconnect con1;
connect(localhost,root,wrong_pwd,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,root,wrong_pwd,mysql;
ERROR 28000: Access denied for user 'root'@'localhost' (using password: YES)
connection default;
connect(localhost,no_such_user,,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,no_such_user,,mysql;
ERROR 28000: Access denied for user 'no_such_user'@'localhost' (using password: NO)
connection default;
CREATE DATABASE d1;
CREATE TABLE d1.t1 (id int);
INSERT INTO d1.t1 VALUES (1);
SELECT * from d1.t1;
id
1
UPDATE d1.t1 SET id=2;
DELETE FROM d1.t1;
ALTER TABLE d1.t1 ADD COLUMN (id2 int);
RENAME TABLE d1.t1 to d1.t2;
DROP TABLE d1.t2;
DROP DATABASE d1;
CREATE USER u1 IDENTIFIED BY 'pwd-123';
GRANT ALL ON *.* TO u1 IDENTIFIED BY "pwd-321";
SET PASSWORD FOR u1 = PASSWORD('pwd 098');
drop user u1;
select * from test.t_doesnt_exist;
ERROR 42S02: Table 'test.t_doesnt_exist' doesn't exist
syntax_error_query;
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'syntax_error_query' at line 1
UPDATE mysql.server_audit_users SET filtername= 'query_read' where host='%' and user='root';
SET GLOBAL server_audit_reload_filters=ON;
SHOW STATUS LIKE "Server_audit_session_filter";
Variable_name	Value
Server_audit_session_filter	query_read
connect  con1,localhost,root,,mysql;
connection default;
disconnect con1;
connect(localhost,root,wrong_pwd,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,root,wrong_pwd,mysql;
ERROR 28000: Access denied for user 'root'@'localhost' (using password: YES)
connection default;
connect(localhost,no_such_user,,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,no_such_user,,mysql;
ERROR 28000: Access denied for user 'no_such_user'@'localhost' (using password: NO)
connection default;
CREATE DATABASE d1;
CREATE TABLE d1.t1 (id int);
INSERT INTO d1.t1 VALUES (1);
SELECT * from d1.t1;
id
1
UPDATE d1.t1 SET id=2;
DELETE FROM d1.t1;
ALTER TABLE d1.t1 ADD COLUMN (id2 int);
RENAME TABLE d1.t1 to d1.t2;
DROP TABLE d1.t2;
DROP DATABASE d1;
CREATE USER u1 IDENTIFIED BY 'pwd-123';
GRANT ALL ON *.* TO u1 IDENTIFIED BY "pwd-321";
SET PASSWORD FOR u1 = PASSWORD('pwd 098');
drop user u1;
select * from test.t_doesnt_exist;
ERROR 42S02: Table 'test.t_doesnt_exist' doesn't exist
syntax_error_query;
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'syntax_error_query' at line 1
UPDATE mysql.server_audit_users SET filtername= 'query_write' where host='%' and user='root';
SET GLOBAL server_audit_reload_filters=ON;
SHOW STATUS LIKE "Server_audit_session_filter";
Variable_name	Value
Server_audit_session_filter	query_write
connect  con1,localhost,root,,mysql;
connection default;
disconnect con1;
connect(localhost,root,wrong_pwd,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,root,wrong_pwd,mysql;
ERROR 28000: Access denied for user 'root'@'localhost' (using password: YES)
connection default;
connect(localhost,no_such_user,,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,no_such_user,,mysql;
ERROR 28000: Access denied for user 'no_such_user'@'localhost' (using password: NO)
connection default;
CREATE DATABASE d1;
CREATE TABLE d1.t1 (id int);
INSERT INTO d1.t1 VALUES (1);
SELECT * from d1.t1;
id
1
UPDATE d1.t1 SET id=2;
DELETE FROM d1.t1;
ALTER TABLE d1.t1 ADD COLUMN (id2 int);
RENAME TABLE d1.t1 to d1.t2;
DROP TABLE d1.t2;
DROP DATABASE d1;
CREATE USER u1 IDENTIFIED BY 'pwd-123';
GRANT ALL ON *.* TO u1 IDENTIFIED BY "pwd-321";
SET PASSWORD FOR u1 = PASSWORD('pwd 098');
drop user u1;
select * from test.t_doesnt_exist;
ERROR 42S02: Table 'test.t_doesnt_exist' doesn't exist
syntax_error_query;
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'syntax_error_query' at line 1
UPDATE mysql.server_audit_users SET filtername= 'query_dml' where host='%' and user='root';
SET GLOBAL server_audit_reload_filters=ON;
SHOW STATUS LIKE "Server_audit_session_filter";
Variable_name	Value
Server_audit_session_filter	query_dml
connect  con1,localhost,root,,mysql;
connection default;
disconnect con1;
connect(localhost,root,wrong_pwd,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,root,wrong_pwd,mysql;
ERROR 28000: Access denied for user 'root'@'localhost' (using password: YES)
connection default;
connect(localhost,no_such_user,,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,no_such_user,,mysql;
ERROR 28000: Access denied for user 'no_such_user'@'localhost' (using password: NO)
connection default;
CREATE DATABASE d1;
CREATE TABLE d1.t1 (id int);
INSERT INTO d1.t1 VALUES (1);
SELECT * from d1.t1;
id
1
UPDATE d1.t1 SET id=2;
DELETE FROM d1.t1;
ALTER TABLE d1.t1 ADD COLUMN (id2 int);
RENAME TABLE d1.t1 to d1.t2;
DROP TABLE d1.t2;
DROP DATABASE d1;
CREATE USER u1 IDENTIFIED BY 'pwd-123';
GRANT ALL ON *.* TO u1 IDENTIFIED BY "pwd-321";
SET PASSWORD FOR u1 = PASSWORD('pwd 098');
drop user u1;
select * from test.t_doesnt_exist;
ERROR 42S02: Table 'test.t_doesnt_exist' doesn't exist
syntax_error_query;
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'syntax_error_query' at line 1
UPDATE mysql.server_audit_users SET filtername= 'query_ddl' where host='%' and user='root';
SET GLOBAL server_audit_reload_filters=ON;
SHOW STATUS LIKE "Server_audit_session_filter";
Variable_name	Value
Server_audit_session_filter	query_ddl
connect  con1,localhost,root,,mysql;
connection default;
disconnect con1;
connect(localhost,root,wrong_pwd,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,root,wrong_pwd,mysql;
ERROR 28000: Access denied for user 'root'@'localhost' (using password: YES)
connection default;
connect(localhost,no_such_user,,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,no_such_user,,mysql;
ERROR 28000: Access denied for user 'no_such_user'@'localhost' (using password: NO)
connection default;
CREATE DATABASE d1;
CREATE TABLE d1.t1 (id int);
INSERT INTO d1.t1 VALUES (1);
SELECT * from d1.t1;
id
1
UPDATE d1.t1 SET id=2;
DELETE FROM d1.t1;
ALTER TABLE d1.t1 ADD COLUMN (id2 int);
RENAME TABLE d1.t1 to d1.t2;
DROP TABLE d1.t2;
DROP DATABASE d1;
CREATE USER u1 IDENTIFIED BY 'pwd-123';
GRANT ALL ON *.* TO u1 IDENTIFIED BY "pwd-321";
SET PASSWORD FOR u1 = PASSWORD('pwd 098');
drop user u1;
select * from test.t_doesnt_exist;
ERROR 42S02: Table 'test.t_doesnt_exist' doesn't exist
syntax_error_query;
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'syntax_error_query' at line 1
UPDATE mysql.server_audit_users SET filtername= 'query_dcl' where host='%' and user='root';
SET GLOBAL server_audit_reload_filters=ON;
SHOW STATUS LIKE "Server_audit_session_filter";
Variable_name	Value
Server_audit_session_filter	query_dcl
connect  con1,localhost,root,,mysql;
connection default;
disconnect con1;
connect(localhost,root,wrong_pwd,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,root,wrong_pwd,mysql;
ERROR 28000: Access denied for user 'root'@'localhost' (using password: YES)
connection default;
connect(localhost,no_such_user,,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,no_such_user,,mysql;
ERROR 28000: Access denied for user 'no_such_user'@'localhost' (using password: NO)
connection default;
CREATE DATABASE d1;
CREATE TABLE d1.t1 (id int);
INSERT INTO d1.t1 VALUES (1);
SELECT * from d1.t1;
id
1
UPDATE d1.t1 SET id=2;
DELETE FROM d1.t1;
ALTER TABLE d1.t1 ADD COLUMN (id2 int);
RENAME TABLE d1.t1 to d1.t2;
DROP TABLE d1.t2;
DROP DATABASE d1;
CREATE USER u1 IDENTIFIED BY 'pwd-123';
GRANT ALL ON *.* TO u1 IDENTIFIED BY "pwd-321";
SET PASSWORD FOR u1 = PASSWORD('pwd 098');
drop user u1;
select * from test.t_doesnt_exist;
ERROR 42S02: Table 'test.t_doesnt_exist' doesn't exist
syntax_error_query;
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'syntax_error_query' at line 1
UPDATE mysql.server_audit_users SET filtername= 'query_dml_no_select' where host='%' and user='root';
SET GLOBAL server_audit_reload_filters=ON;
SHOW STATUS LIKE "Server_audit_session_filter";
Variable_name	Value
Server_audit_session_filter	query_dml_no_select
connect  con1,localhost,root,,mysql;
connection default;
disconnect con1;
connect(localhost,root,wrong_pwd,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,root,wrong_pwd,mysql;
ERROR 28000: Access denied for user 'root'@'localhost' (using password: YES)
connection default;
connect(localhost,no_such_user,,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,no_such_user,,mysql;
ERROR 28000: Access denied for user 'no_such_user'@'localhost' (using password: NO)
connection default;
CREATE DATABASE d1;
CREATE TABLE d1.t1 (id int);
INSERT INTO d1.t1 VALUES (1);
SELECT * from d1.t1;
id
1
UPDATE d1.t1 SET id=2;
DELETE FROM d1.t1;
ALTER TABLE d1.t1 ADD COLUMN (id2 int);
RENAME TABLE d1.t1 to d1.t2;
DROP TABLE d1.t2;
DROP DATABASE d1;
CREATE USER u1 IDENTIFIED BY 'pwd-123';
GRANT ALL ON *.* TO u1 IDENTIFIED BY "pwd-321";
SET PASSWORD FOR u1 = PASSWORD('pwd 098');
drop user u1;
select * from test.t_doesnt_exist;
ERROR 42S02: Table 'test.t_doesnt_exist' doesn't exist
syntax_error_query;
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'syntax_error_query' at line 1
UPDATE mysql.server_audit_users SET filtername= 'query_combined' where host='%' and user='root';
SET GLOBAL server_audit_reload_filters=ON;
SHOW STATUS LIKE "Server_audit_session_filter";
Variable_name	Value
Server_audit_session_filter	query_combined
connect  con1,localhost,root,,mysql;
connection default;
disconnect con1;
connect(localhost,root,wrong_pwd,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,root,wrong_pwd,mysql;
ERROR 28000: Access denied for user 'root'@'localhost' (using password: YES)
connection default;
connect(localhost,no_such_user,,mysql,MASTER_PORT,MASTER_SOCKET);
connect  con1,localhost,no_such_user,,mysql;
ERROR 28000: Access denied for user 'no_such_user'@'localhost' (using password: NO)
connection default;
CREATE DATABASE d1;
CREATE TABLE d1.t1 (id int);
INSERT INTO d1.t1 VALUES (1);
SELECT * from d1.t1;
id
1
UPDATE d1.t1 SET id=2;
DELETE FROM d1.t1;
ALTER TABLE d1.t1 ADD COLUMN (id2 int);
RENAME TABLE d1.t1 to d1.t2;
DROP TABLE d1.t2;
DROP DATABASE d1;
CREATE USER u1 IDENTIFIED BY 'pwd-123';
GRANT ALL ON *.* TO u1 IDENTIFIED BY "pwd-321";
SET PASSWORD FOR u1 = PASSWORD('pwd 098');
drop user u1;
select * from test.t_doesnt_exist;
ERROR 42S02: Table 'test.t_doesnt_exist' doesn't exist
syntax_error_query;
ERROR 42000: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'syntax_error_query' at line 1
uninstall plugin server_audit;
Warnings:
Warning	1620	Plugin is busy and will be uninstalled on shutdown
truncate mysql.server_audit_filters;
truncate mysql.server_audit_users;
TIME,HOSTNAME,,,0,0,AUDIT_CONFIG,,file_path=server_audit.log,0
TIME,HOSTNAME,,,0,0,AUDIT_CONFIG,,rotate_size=1000000,0
TIME,HOSTNAME,,,0,0,AUDIT_CONFIG,,file_rotations=9,0
TIME,HOSTNAME,root,localhost,ID,0,AUDIT_CONFIG,test,logging=ON,0
TIME,HOSTNAME,root,localhost,ID,0,AUDIT_CONFIG,test,reload_filters=ON,0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,test,'SET GLOBAL server_audit_reload_filters=ON',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,test,'SHOW STATUS LIKE "Server_audit_session_filter"',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'CREATE DATABASE d1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'CREATE TABLE d1.t1 (id int)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'INSERT INTO d1.t1 VALUES (1)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'SELECT * from d1.t1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'UPDATE d1.t1 SET id=2',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'DELETE FROM d1.t1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'ALTER TABLE d1.t1 ADD COLUMN (id2 int)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'RENAME TABLE d1.t1 to d1.t2',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'DROP TABLE d1.t2',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'DROP DATABASE d1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'CREATE USER u1 IDENTIFIED BY *****',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'GRANT ALL ON *.* TO u1 IDENTIFIED BY *****',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'SET PASSWORD FOR u1 = PASSWORD(*****)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'drop user u1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'select * from test.t_doesnt_exist',ID
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'syntax_error_query',ID
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'UPDATE mysql.server_audit_users SET filtername= \'query_read\' where host=\'%\' and user=\'root\'',0
TIME,HOSTNAME,root,localhost,ID,0,AUDIT_CONFIG,,reload_filters=ON,0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'SELECT * from d1.t1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'select * from test.t_doesnt_exist',ID
TIME,HOSTNAME,root,localhost,ID,0,AUDIT_CONFIG,,reload_filters=ON,0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'INSERT INTO d1.t1 VALUES (1)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'UPDATE d1.t1 SET id=2',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'DELETE FROM d1.t1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'UPDATE mysql.server_audit_users SET filtername= \'query_dml\' where host=\'%\' and user=\'root\'',0
TIME,HOSTNAME,root,localhost,ID,0,AUDIT_CONFIG,,reload_filters=ON,0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'INSERT INTO d1.t1 VALUES (1)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'SELECT * from d1.t1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'UPDATE d1.t1 SET id=2',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'DELETE FROM d1.t1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'select * from test.t_doesnt_exist',ID
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'UPDATE mysql.server_audit_users SET filtername= \'query_ddl\' where host=\'%\' and user=\'root\'',0
TIME,HOSTNAME,root,localhost,ID,0,AUDIT_CONFIG,,reload_filters=ON,0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'CREATE DATABASE d1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'CREATE TABLE d1.t1 (id int)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'ALTER TABLE d1.t1 ADD COLUMN (id2 int)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'RENAME TABLE d1.t1 to d1.t2',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'DROP TABLE d1.t2',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'DROP DATABASE d1',0
TIME,HOSTNAME,root,localhost,ID,0,AUDIT_CONFIG,,reload_filters=ON,0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'CREATE USER u1 IDENTIFIED BY *****',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'GRANT ALL ON *.* TO u1 IDENTIFIED BY *****',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'SET PASSWORD FOR u1 = PASSWORD(*****)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'drop user u1',0
TIME,HOSTNAME,root,localhost,ID,0,AUDIT_CONFIG,,reload_filters=ON,0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'INSERT INTO d1.t1 VALUES (1)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'UPDATE d1.t1 SET id=2',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'DELETE FROM d1.t1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'UPDATE mysql.server_audit_users SET filtername= \'query_combined\' where host=\'%\' and user=\'root\'',0
TIME,HOSTNAME,root,localhost,ID,0,AUDIT_CONFIG,,reload_filters=ON,0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'CREATE DATABASE d1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'CREATE TABLE d1.t1 (id int)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'ALTER TABLE d1.t1 ADD COLUMN (id2 int)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'RENAME TABLE d1.t1 to d1.t2',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'DROP TABLE d1.t2',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'DROP DATABASE d1',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'CREATE USER u1 IDENTIFIED BY *****',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'GRANT ALL ON *.* TO u1 IDENTIFIED BY *****',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'SET PASSWORD FOR u1 = PASSWORD(*****)',0
TIME,HOSTNAME,root,localhost,ID,ID,QUERY,,'drop user u1',0
