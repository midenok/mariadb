stages:
- prepare
- build

ubuntu-self-contained:
  stage: build
  image: ubuntu:18.04
  script:
  - mkdir build
  - mkdir build/mkdist
  - cd build/mkdist
  - cmake ../..

ubuntu-system-dependencies:
  stage: prepare
  image: ubuntu:18.04
  script:
  - whoami
  - cat /etc/apt/sources.list
  - sed -i~orig -e 's/# deb-src/deb-src/' /etc/apt/sources.list
  - cat /etc/apt/sources.list
  - sudo add-apt-repository main
  - sudo add-apt-repository universe
  - sudo add-apt-repository restricted
  - sudo add-apt-repository multiverse
  - cat /etc/apt/sources.list
  - apt-get update
  - apt-get install -y -q \
    apt-utils build-essential cmake python-dev sudo git \
    devscripts equivs libcurl4-openssl-dev \
    ccache python3 python3-pip curl libssl-dev libzstd-dev \
    libevent-dev dpatch gawk gdb libboost-dev libcrack2-dev \
    libjudy-dev libnuma-dev libsnappy-dev libxml2-dev \
    unixodbc-dev uuid-dev fakeroot iputils-ping